<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

<script id="MathJax-script" async 
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>

<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
</head>

<body>




<h1> Excedance Number of Derangement in Multi-Set<font size="3"> <a href="./index.html"> (back to Data page)</a></font></h1>

<h1>定義：</h1>
<ul>

<li>$M=\{ 1^{a_1}, 2^{a_2}, ..., n^{a_n}\}$ is a multi-set, where $a_i \in \mathbb{N}$ and 1~n repeated a times n $M$. </li><br>
<li>$N=\sum^n_{i=1}i\cdot a_i$</li><br>
<li>$\pi = \pi_1\pi_2  \cdots \pi_{N}$ is one line permutation in $\mathcal{S}_M$</li><br>


<ul>
<li> The excedance set $EXC(\pi)= \Big| \{ i \in [N-1] \mid \pi_i > i \} \Big|$</li><br>
<li> $exc(\pi)$= $ \Big| EXC(\pi) \Big|$</li><br>
</ul><br>

<li>$\pi = \pi_1\pi_2  \cdots \pi_{N}$ is called a derangement in $\mathcal{S}_M$ if $\pi_i \neq i$ for all $i$</li>
</ul>

<a href="https://colab.research.google.com/drive/1sSGo1JtLajOnG2zCSHxHUYGXr-DMgChK?authuser=1#scrollTo=UWzj8mJ3yQle"> google colab</a><br>

<hr>

<h1>目錄：</h1>


<ul>
  <li><a href="#a=2"> $a_1=a_2=...=a_n=2$</a></li>
  <li><a href="#a1=3, a=2"> $a_1=3, a_2=...=a_n=2$</a></li>
  <li><a href="#a2=3, a=2"> $a_1=2, a_2=3, a_3=...=a_n=2$</a></li>
  <li><a href="#ao=2, ae=3"> $a_{odd}=2, a_{even}=3$</a></li>
  <li><a href="#a=3"> $a_1=a_2=...=a_n=3$</a></li>
  <li><a href="#a1=2, a=3"> $a_1=2, a_2=...=a_n=3$</a></li>
  <li><a href="#a2=2, a=3"> $a_1=3, a_2=2, a_3=...=a_n=3$</a></li>
  <li><a href="#ao=3, ae=2"> $a_{odd}=3, a_{even}=2$</a></li>
</ul>


<hr>
<h1><span id="a=2">$a_1=a_2=...=a_n=2$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">2</td>
  <td>1</td><td>2</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">30</td>
  <td>2</td><td>15</td>
</tr>

<tr>
  <td>1</td><td>15</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">864</td>
  <td>3</td><td>162</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>540</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>162</td>
</tr>

<tr>
  <td rowspan="4">5</td>
  <td rowspan="4">39480</td>
  <td>4</td><td>2520</td>
</tr>

<tr>
  <td>3</td><td>17220</td>
</tr>

<tr>
  <td>2</td><td>17220</td>
</tr>

<tr>
  <td>1</td><td>2520</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="5">6</td>
  <td rowspan="5">2631600</td>
  <td>5</td><td>54000</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>4</td><td>617400</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>3</td><td>1288800</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>617400</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>54000</td>
</tr>




</table>
<br>







<hr>
<h1><span id="a1=3, a=2">$a_1=3, a_2=...=a_n=2$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">3</td>
  <td>1</td><td>3</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">68</td>
  <td>2</td><td>26</td>
</tr>

<tr>
  <td>1</td><td>42</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">2550</td>
  <td>3</td><td>330</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>1500</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>720</td>
</tr>

<tr>
  <td rowspan="4">5</td>
  <td rowspan="4">143280</td>
  <td>4</td><td>5940</td>
</tr>

<tr>
  <td>3</td><td>51120</td>
</tr>

<tr>
  <td>2</td><td>70020</td>
</tr>

<tr>
  <td>1</td><td>16200</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="5">6</td>
  <td rowspan="5">11323200</td>
  <td>5</td><td>144900</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>4</td><td>1991850</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>3</td><td>5264700</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>3449250</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>472500</td>
</tr>



</table>
<br>





<hr>
<h1><span id="a2=3, a=2"> $a_1=2, a_2=3, a_3=...=a_n=2$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">3</td>
  <td>1</td><td>3</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">68</td>
  <td>2</td><td>34</td>
</tr>

<tr>
  <td>1</td><td>34</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">2550</td>
  <td>3</td><td>410</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>1600</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>540</td>
</tr>

<tr>
  <td rowspan="4">5</td>
  <td rowspan="4">143280</td>
  <td>4</td><td>7110</td>
</tr>

<tr>
  <td>3</td><td>56700</td>
</tr>

<tr>
  <td>2</td><td>67770</td>
</tr>

<tr>
  <td>1</td><td>11700</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="5">6</td>
  <td rowspan="5">11323200</td>
  <td>5</td><td>168840</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>4</td><td>2216550</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>3</td><td>5449920</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>3153990</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>333900</td>
</tr>


</table>
<br>







<hr>
<h1><span id="a0=2, ae=3"> $a_{odd}=2, a_{even}=3$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">3</td>
  <td>1</td><td>3</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">68</td>
  <td>2</td><td>34</td>
</tr>

<tr>
  <td>1</td><td>34</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">8440</td>
  <td>3</td><td>2070</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>5090</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>1280</td>
</tr>

<tr>
  <td rowspan="4">5</td>
  <td rowspan="4">569940</td>
  <td>4</td><td>36680</td>
</tr>

<tr>
  <td>3</td><td>248290</td>
</tr>

<tr>
  <td>2</td><td>248290</td>
</tr>

<tr>
  <td>1</td><td>36680</td>
</tr>


</table>
<br>








<hr>
<h1><span id="a=3">$a_1=a_2=...=a_n=3$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">6</td>
  <td>1</td><td>6</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">540</td>
  <td>2</td><td>270</td>
</tr>

<tr>
  <td>1</td><td>270</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">123480</td>
  <td>3</td><td>24920</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>73640</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>24920</td>
</tr>


</table>
<br>





<hr>
<h1><span id="a1=2, a=3">$a_1=2, a_2=...=a_n=3$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>


<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">3</td>
  <td>1</td><td>3</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">180</td>
  <td>2</td><td>110</td>
</tr>

<tr>
  <td>1</td><td>70</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">30870</td>
  <td>3</td><td>8120</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>18620</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>4130</td>
</tr>

<tr>
  <td rowspan="4">5</td>
  <td rowspan="4">11481120</td>
  <td>4</td><td>1161720</td>
</tr>

<tr>
  <td>3</td><td>5517960</td>
</tr>

<tr>
  <td>2</td><td>4293240</td>
</tr>

<tr>
  <td>1</td><td>508200</td>
</tr>

</table>
<br>





<hr>
<h1><span id="a2=2, a=3">$a_1=3, a_2=2, a_3=...=a_n=3$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">3</td>
  <td>1</td><td>3</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">180</td>
  <td>2</td><td>90</td>
</tr>

<tr>
  <td>1</td><td>90</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">30870</td>
  <td>3</td><td>7000</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>18200</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>5670</td>
</tr>

</table>
<br>






<hr>
<h1><span id="ao=3, ae=2">$a_{odd}=3, a_{even}=2$</span></h1>

<table border="1" cellpadding="5" style="text-align:center;">
<tr style="background-color: #ffe4e1">
  <td>n</td> <td>total</td>  <td>$exc(\pi)$</td> <td>numbers</td> 
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="1">2</td>
  <td rowspan="1">3</td>
  <td>1</td><td>3</td>
</tr>

<tr>
  <td rowspan="2">3</td>
  <td rowspan="2">180</td>
  <td>2</td><td>90</td>
</tr>

<tr>
  <td>1</td><td>90</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td rowspan="3">4</td>
  <td rowspan="3">8440</td>
  <td>3</td><td>1280</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>2</td><td>5090</td>
</tr>

<tr style="background-color: #e6e6e6">
  <td>1</td><td>2070</td>
</tr>

<tr>
  <td rowspan="4">5</td>
  <td rowspan="4">2462880</td>
  <td>4</td><td>186480</td>
</tr>

<tr>
  <td>3</td><td>1044960</td>
</tr>

<tr>
  <td>2</td><td>1044960</td>
</tr>

<tr>
  <td>1</td><td>186480</td>
</tr>

</table>
<br>

</body>
</html>